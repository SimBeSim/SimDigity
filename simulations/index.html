<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <title>SimDigity | Fysica & Massa Validatie</title>
    <style>
        body { margin: 0; background-color: #FFF; overflow: hidden; font-family: 'Segoe UI', sans-serif; }
        canvas { display: block; position: fixed; top: 0; left: 0; z-index: 1; }
        
        #ui { position: absolute; top: 20px; left: 20px; color: #333; z-index: 10; pointer-events: none; }
        
        /* Data Paneel Linksonder */
        #data-panel {
            position: absolute; bottom: 20px; left: 20px;
            background: rgba(0, 0, 0, 0.8); color: #0f0; /* Matrix/Hacker stijl voor data */
            padding: 15px; border-radius: 8px; font-family: 'Courier New', monospace;
            z-index: 10; font-size: 0.85em; width: 320px;
        }

        #controls {
            position: absolute; top: 20px; right: 20px; 
            background: rgba(255, 255, 255, 0.95); padding: 20px; 
            border-radius: 12px; box-shadow: 0 8px 20px rgba(0,0,0,0.15);
            width: 280px; z-index: 10; max-height: 90vh; overflow-y: auto;
        }
        button { width: 100%; padding: 10px; margin-top: 5px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; font-weight: bold; }
        .data-val { color: #fff; font-weight: bold; }
    </style>
</head>
<body>

    <div id="ui">
        <h1>SimDigity: Fysica Validatie</h1>
    </div>

    <div id="data-panel">
        <div style="border-bottom: 1px solid #0f0; margin-bottom: 5px;">LIVE PHYSICAL DATA</div>
        Massa WTC 1: <span class="data-val">500.000.000 kg</span><br>
        Massa Boeing 767: <span class="data-val">179.000 kg</span><br>
        Kerosine Volume: <span class="data-val">38.000 L</span><br>
        Energie-Potentieel: <span class="data-val">1.4 Terajoule</span><br>
        <br>
        <div style="font-size: 0.8em; color: #aaa;">Theorie: Balk-doorbuiging door hitte verzwakt perimeter kolommen.</div>
    </div>

    <div id="controls">
        <h3>Inspectie Tools</h3>
        <label>Camera Afstand</label>
        <input type="range" id="zoom" min="20" max="400" value="100" style="width:100%">
        
        <h4>Positie Vliegtuig 1</h4>
        <input type="range" id="px" min="-40" max="40" value="-15" style="width:100%">
        <label>Hoogte (Verdieping 93-99)</label>
        <input type="range" id="py" min="0" max="50" value="35" style="width:100%">
        
        <button id="focusImpact">Focus Impact Zone</button>
        <button id="resetView" style="background:#666">Reset Overzicht</button>
    </div>

    <script type="importmap">
        { "imports": { "three": "https://unpkg.com/three@0.160.0/build/three.module.js" } }
    </script>

    <script type="module">
        import * as THREE from 'three';

        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0xffffff);
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // De Toren (WTC 1) - Meer detail in de structuur
        function createDetailedTower(height) {
            const group = new THREE.Group();
            const h = height / 10;
            // Buitenkant (licht transparant om kern te tonen)
            const shell = new THREE.Mesh(
                new THREE.BoxGeometry(6.34, h, 6.34), 
                new THREE.MeshPhongMaterial({color: 0xdddddd, transparent: true, opacity: 0.7})
            );
            group.add(shell);
            // De Kern (Core) - Waar de balken aan vastzitten
            const core = new THREE.Mesh(
                new THREE.BoxGeometry(2.5, h, 2.5), 
                new THREE.MeshPhongMaterial({color: 0x666666})
            );
            group.add(core);
            return group;
        }

        const tower1 = createDetailedTower(416.97);
        tower1.position.y = 20.85;
        scene.add(tower1);

        // Boeing 767 (Exacte schaal naar tekening)
        const plane = new THREE.Group();
        const fuselage = new THREE.Mesh(new THREE.CylinderGeometry(0.25, 0.25, 4.85), new THREE.MeshPhongMaterial({color: 0x3366ff}));
        fuselage.rotation.x = Math.PI/2; plane.add(fuselage);
        const wings = new THREE.Mesh(new THREE.BoxGeometry(4.76, 0.05, 1.2), new THREE.MeshPhongMaterial({color: 0x3366ff}));
        wings.position.z = 0.5; plane.add(wings);
        scene.add(plane);

        const light = new THREE.DirectionalLight(0xffffff, 2);
        light.position.set(50, 100, 50); scene.add(light);
        scene.add(new THREE.AmbientLight(0xaaaaaa));

        const inputs = {
            zoom: document.getElementById('zoom'),
            px: document.getElementById('px'),
            py: document.getElementById('py')
        };

        let targetLookAt = new THREE.Vector3(0, 35, 0);

        document.getElementById('focusImpact').onclick = () => {
            targetLookAt.set(0, 35, 0);
            inputs.zoom.value = 40;
        };

        function animate() {
            requestAnimationFrame(animate);
            const radius = parseFloat(inputs.zoom.value);
            camera.position.set(radius, radius * 0.5 + 20, radius);
            camera.lookAt(targetLookAt);

            plane.position.set(parseFloat(inputs.px.value), parseFloat(inputs.py.value), 10);
            plane.lookAt(0, parseFloat(inputs.py.value), 0);

            renderer.render(scene, camera);
        }
        animate();
    </script>
</body>
</html>
